# ุชุณุช ุณูุงุฑู ุจุฏูู ูพฺฉุฌ ูุนุงู

## ุณูุงุฑู: ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ ูุนุงู

### ูุฏู
ุฒูุงู ฺฉู ูุดุชุฑ ฺฉุฏ ฺฉุชุง ฺฉุณุจโูฺฉุงุฑ ุฑุง ูุงุฑุฏ ูโฺฉูุฏ ฺฉู ูพฺฉุฌ ูุนุงู ูุฏุงุฑุฏุ ุจุงุฏ ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ุดูุฏ ู ุจู ุตูุญู ฺฏุฒููโูุง ูุฑูุฏ.

---

## ูุฑุงุญู ุขูุงุฏูโุณุงุฒ

### 1. ุงุฌุงุฏ ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ ูุนุงู

ุงุฒ Django Admin:

```
1. ุจู /admin ุจุฑูุฏ
2. ฺฉ Business User ุงุฌุงุฏ ฺฉูุฏ:
   - username: business_no_package
   - phone_number: 09121234567
   - role: business

3. BusinessProfile ุฑุง ฺฉุงูู ฺฉูุฏ:
   - name: ฺฉุณุจโูฺฉุงุฑ ุชุณุช
   - category: ฺฉ ุฏุณุชู ุงูุชุฎุงุจ ฺฉูุฏ
   - city: ฺฉ ุดูุฑ ุงูุชุฎุงุจ ฺฉูุฏ
   - address: ุขุฏุฑุณ ุชุณุช
   - business_phone: 09121234567
   - business_location_latitude: 35.6892
   - business_location_longitude: 51.3890
   
4. unique_code ุฑุง ุงุฏุฏุงุดุช ฺฉูุฏ (ูุซูุงู: 111111)

5. ูฺ Package ุงุฌุงุฏ ูฺฉูุฏ ุง:
   - Package ุงุฌุงุฏ ฺฉูุฏ ุงูุง is_active = False
   - ุง status = 'draft'
```

### 2. ุงุฌุงุฏ ูุดุชุฑ

```
ุงุฒ Django Admin ฺฉ Customer ุงุฌุงุฏ ฺฉูุฏ:
- username: customer_test
- phone_number: 09129876543
- role: customer
```

---

## ุชุณุชโูุง

### ุชุณุช 1: ูุฑูุฏ ฺฉุฏ ฺฉุชุง ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ

**ูุฑุงุญู:**

1. ุจุง ุญุณุงุจ ูุดุชุฑ ูุงฺฏู ฺฉูุฏ
```
URL: http://localhost:5173/
Username: customer_test
Password: [password]
```

2. ุฏฺฉูู QR Scanner ุฑุง ฺฉูฺฉ ฺฉูุฏ

3. ุฑู "ูุงุฑุฏ ฺฉุฑุฏู ฺฉุฏ ฺฉุชุง ุจู ุตูุฑุช ุฏุณุช" ฺฉูฺฉ ฺฉูุฏ

4. ฺฉุฏ ฺฉุชุง ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ ุฑุง ูุงุฑุฏ ฺฉูุฏ:
```
Input: 111111
```

5. ุฏฺฉูู "ุชุงุฏ" ุฑุง ุจุฒูุฏ

**ูุชุฌู ุงูุชุธุงุฑ:**

โ **ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ุดูุฏ:**
```
"ุงู ฺฉุณุจโูฺฉุงุฑ ุฏุฑ ุญุงู ุญุงุถุฑ ูพฺฉุฌ ูุนุงู ูุฏุงุฑุฏ"
```

โ **UI ุจุงุฏ ุดุงูู:**
- ุขฺฉูู ุฎุทุง (ุฏุงุฑู ูุฑูุฒ ุจุง ุนูุงูุช ุชุนุฌุจ)
- ุนููุงู "ุฎุทุง"
- ูุชู ูพุงู ุฎุทุง
- ุฏฺฉูู "ุชูุงุด ูุฌุฏุฏ"

โ **Popup BusinessOptions ุจุงุฒ ูุดูุฏ**

โ **ูุดุชุฑ ุฏุฑ QRScannerModal ุจุงู ุจูุงูุฏ**

---

### ุชุณุช 2: ุชูุงุด ูุฌุฏุฏ ูพุณ ุงุฒ ุฎุทุง

**ูุฑุงุญู:**

1. ุจุนุฏ ุงุฒ ูุดุงูุฏู ุฎุทุงุ ุฏฺฉูู "ุชูุงุด ูุฌุฏุฏ" ุฑุง ุจุฒูุฏ

**ูุชุฌู ุงูุชุธุงุฑ:**

โ ูพุงู ุฎุทุง ูพุงฺฉ ุดูุฏ

โ ุฏูุฑุจู ุฏูุจุงุฑู ูุนุงู ุดูุฏ (ุง ูุฑู ูุฑูุฏ ุฏุณุช ูพุงฺฉ ุดูุฏ)

โ ุขูุงุฏู ุงุณฺฉู ุง ูุฑูุฏ ฺฉุฏ ุฌุฏุฏ ุจุงุดุฏ

---

### ุชุณุช 3: ุงุณฺฉู QR Code ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ

**ูุฑุงุญู:**

1. ฺฉ QR Code ุจุง ูุญุชูุง ฺฉุฏ ฺฉุชุง ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ ุจุณุงุฒุฏ

2. QR Scanner ุฑุง ุจุงุฒ ฺฉูุฏ

3. QR Code ุฑุง ุงุณฺฉู ฺฉูุฏ

**ูุชุฌู ุงูุชุธุงุฑ:**

โ ููุงู ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ุดูุฏ

โ ุจู BusinessOptions ูุฑูุฏ

---

### ุชุณุช 4: ูุฑูุฏ ฺฉุฏ ฺฉุณุจโูฺฉุงุฑ ุจุง ูพฺฉุฌ ูุนุงู (ูุซุจุช)

**ุขูุงุฏูโุณุงุฒ:**
- ฺฉ ฺฉุณุจโูฺฉุงุฑ ุจุง ูพฺฉุฌ ูุนุงู ุงุฌุงุฏ ฺฉูุฏ (unique_code: 222222)

**ูุฑุงุญู:**

1. QR Scanner ุฑุง ุจุงุฒ ฺฉูุฏ

2. ฺฉุฏ 222222 ุฑุง ูุงุฑุฏ ฺฉูุฏ

**ูุชุฌู ุงูุชุธุงุฑ:**

โ **ุจุฏูู ุฎุทุง** ุจู BusinessOptions ุจุฑูุฏ

โ 3 ฺฏุฒูู ููุงุด ุฏุงุฏู ุดูุฏ

โ ุงูุชุงุฒ ู VIP status ููุงุด ุฏุงุฏู ุดูุฏ

---

## ุจุฑุฑุณ API Response

### ุฏุฑุฎูุงุณุช ุจุฑุง ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูพฺฉุฌ:

```bash
curl -H "Authorization: Bearer <token>" \
  "http://localhost:8000/api/loyalty/business-by-code/?code=111111"
```

**ูพุงุณุฎ ุงูุชุธุงุฑ:**

```json
{
  "business_id": 1,
  "business_name": "ฺฉุณุจโูฺฉุงุฑ ุชุณุช",
  "business_logo": null,
  "business_description": "",
  "has_active_package": false,  // โ ฺฉูุฏ ููู
  "discount_all_percentage": null,
  "has_specific_discount": false,
  "specific_discount_title": null,
  "specific_discount_percentage": null,
  "has_elite_gift": false,
  "elite_gift_title": null,
  "elite_gift_description": null,
  "customer_points": 0,
  "customer_vip_status": "none",
  "elite_gift_target_reached": false,
  "elite_gift_used": false,
  "can_use_elite_gift": false,
  "can_use_vip": false,
  "can_use_vip_plus": false
}
```

---

## ุจุฑุฑุณ Console Logs

### Frontend Console:

```javascript
// ููฺฏุงู ูุงุฑุฏ ฺฉุฑุฏู ฺฉุฏ ุจุฏูู ูพฺฉุฌ:
console.log('Business Info:', businessInfo)
// Output: null

console.log('Error:', error)
// Output: "ุงู ฺฉุณุจโูฺฉุงุฑ ุฏุฑ ุญุงู ุญุงุถุฑ ูพฺฉุฌ ูุนุงู ูุฏุงุฑุฏ"
```

---

## ุญุงูุงุช ูุฎุชูู Package

### ุญุงูุช 1: ูฺ Package ูุฌูุฏ ูุฏุงุฑุฏ
```
business.packages.count() = 0
โ has_active_package = false
โ ุฎุทุง ููุงุด ุฏุงุฏู ูโุดูุฏ
```

### ุญุงูุช 2: Package ูุฌูุฏ ุฏุงุฑุฏ ุงูุง is_active = False
```
business.packages.filter(is_active=True).count() = 0
โ has_active_package = false
โ ุฎุทุง ููุงุด ุฏุงุฏู ูโุดูุฏ
```

### ุญุงูุช 3: Package ูุนุงู ุฏุงุฑุฏ ุงูุง status != 'approved'
```
business.packages.filter(is_active=True, status='approved').count() = 0
โ has_active_package = false
โ ุฎุทุง ููุงุด ุฏุงุฏู ูโุดูุฏ
```

### ุญุงูุช 4: Package ูุนุงู ู ุชุงุฏ ุดุฏู ุฏุงุฑุฏ
```
business.packages.filter(is_active=True, status='approved').count() > 0
โ has_active_package = true
โ ุจู BusinessOptions ูโุฑูุฏ โ
```

---

## ฺฺฉโูุณุช ุชุณุช

- [ ] ฺฉุณุจโูฺฉุงุฑ ุจุฏูู ูฺ Package ุงุฌุงุฏ ุดุฏู
- [ ] ฺฉุฏ ฺฉุชุง ูุงุฑุฏ ุดุฏู
- [ ] ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ุดุฏู
- [ ] ุขฺฉูู ุฎุทุง (ูุฑูุฒ) ููุงุด ุฏุงุฏู ุดุฏู
- [ ] ูุชู ุฎุทุง ูุงุถุญ ู ูุงุฑุณ ุงุณุช
- [ ] ุฏฺฉูู "ุชูุงุด ูุฌุฏุฏ" ฺฉุงุฑ ูโฺฉูุฏ
- [ ] ุจู BusinessOptions ูุฑูุชู
- [ ] QRScannerModal ููฺูุงู ุจุงุฒ ุงุณุช
- [ ] ุจุง ฺฉุณุจโูฺฉุงุฑ ุฏุงุฑุง ูพฺฉุฌ ูุนุงูุ ฺฉุงุฑ ูโฺฉูุฏ
- [ ] API response ุตุญุญ ุงุณุช (has_active_package=false)

---

## ูุดฺฉูุงุช ุงุญุชูุงู ู ุฑุงูโุญู

### ูุดฺฉู: ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ููโุดูุฏ

**ุจุฑุฑุณ:**
```javascript
// ุฏุฑ fetchBusinessInfo:
console.log('has_active_package:', info.has_active_package)
```

**ุฑุงูโุญู:**
- ูุทูุฆู ุดูุฏ API ุจู ุฏุฑุณุช has_active_package ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุดุฑุท `if (!info.has_active_package)` ุงุฌุฑุง ูโุดูุฏ

### ูุดฺฉู: ุจู BusinessOptions ูโุฑูุฏ

**ุจุฑุฑุณ:**
```javascript
console.log('showBusinessOptions:', showBusinessOptions)
console.log('businessInfo:', businessInfo)
```

**ุฑุงูโุญู:**
- ูุทูุฆู ุดูุฏ `setShowBusinessOptions(false)` ูุฑุงุฎูุงู ูโุดูุฏ
- ูุทูุฆู ุดูุฏ `setBusinessInfo(null)` ูุฑุงุฎูุงู ูโุดูุฏ

### ูุดฺฉู: ุฎุทุง API

**ุฑุงูโุญู:**
- ุจุฑุฑุณ ฺฉูุฏ ฺฉุณุจโูฺฉุงุฑ ุจุง unique_code ูุฌูุฏ ุฏุงุฑุฏ
- ุจุฑุฑุณ ฺฉูุฏ token ูุนุชุจุฑ ุงุณุช

---

## ูุชุฌูโฺฏุฑ

ุงู ุชุณุช ุชุถูู ูโฺฉูุฏ ฺฉู:
โ ฺฉุณุจโูฺฉุงุฑูุง ุจุฏูู ูพฺฉุฌ ูุนุงู ุดูุงุณุง ูโุดููุฏ
โ ูพุงู ุฎุทุง ููุงุณุจ ููุงุด ุฏุงุฏู ูโุดูุฏ
โ ูุดุชุฑ ุจู ุตูุญู ฺฏุฒููโูุง ููโุฑูุฏ
โ UX ุจูุจูุฏ ุงูุชู ู ฺฉุงุฑุจุฑ ูุชูุฌู ูุถุนุช ูโุดูุฏ

ูููู ุจุงุดุฏ! ๐
